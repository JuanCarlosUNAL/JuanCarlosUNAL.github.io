{"componentChunkName":"component---src-blog-entries-blog-template-tsx","path":"/wltw/seq2seq-cross-validation","result":{"data":{"allMdx":{"nodes":[{"slug":"blog-entries/en/seq2seq-cross-validation","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Cross validation with sequencial models\",\n  \"created\": \"2021-05-13T00:00:00.000Z\",\n  \"updated\": \"2021-05-13T00:00:00.000Z\",\n  \"lang\": \"en\",\n  \"tags\": \"ML, machine learning, validation, cross validation, k-fold, sequences, seq2seq\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h2\", null, \"First some context\"), mdx(\"p\", null, \"In the lasts days, I been involved in an entity taging project, we already have a model and now we require do some validation with cross validation.\"), mdx(\"h2\", null, \"Cross validation\"), mdx(\"p\", null, \"The dataset is splited in 3 parts. test, validation and training. However this leaves the training set smaller and a training set that could be biased to a class in which the modlel behaves well, giving a wrong idea about the real performace.\"), mdx(\"p\", null, \"Cross validation is a technich to evaluate the model behavior taking advantage of whole data in the training and validation set avoiding these sort of biases.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"521px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/3828a04c506acbd8e40a2dd91852ee39/bb9c5/cross_validation.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"49.33333333333333%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAADNUlEQVQozwEqA9X8AF2SyChbj8QUWo7DGFqPxBVhls0gWom6LU99qilbirssYZLGJ2eHtx1djb4fWZDCKVeDsStVf6wsWH+sLFWMvipaj8EiXoy8Hl6MvSBfkMUaAFyQxQ5FbZUA8///ATZumgBAneAGJ1iFHi5JbDEqVoAmSJ7mFwD//wZh3v8JeaTuGSZikxodT3ciDlWAHW2Exhh6tP8QIP//A1C//w4awP8DAGKZ0hU/YociNlFtLTh6sCCBeI08m4eBinubnZGgkY2OhFhJce4AAE9bMxpLA1ZHT3Y/LFSAPChVry0WVgBoXVMkVEJQdDkhUHM3H0//AAAKAGGY0BRHb5kiQWSJLkOCtiWLa4MmglxOVjxxY1CFWklTaFxSZMFTRGJ+b2VdUW9mXng+J0GFOB87tygNPQBoWDskVkQ+cz0nQHI7JT//AAAIAGCY0BRAZIobNU9sIjl7qx6kZoQddDMdQQBVRUBxIwk+ZmddZst9c3ibkYpxdIR+d2MyIFVpJxJMlBsEUABaTEgkVENEcTokRnE4I0X/AAAJAGKZ0hVEa5MoPFt8ND59ri2daIUneT4qVQtcTFJ4OyVWYTkjUe0BAFdZMBlOAFBDXpSAeIqki4OKt4Z+jj14cXodUkBSeUArVXU9J1P/AAALAF2SyRI9YYUERW2VDE17qAdUfbIBOQgNBBohMQUxCQ8EJRwhBGw+RAVaPEkELjE3CISMlBONnKYTlKasEjk4OgwAAAADAAAAAwAAAAT0AAAAAGCXzxREapEZPFl6ITuAsh2jZoEefz4kQApiUEB9OyJCaEIqQf0QAEVnQig/EGNPPXw3GjyEMRU/uBYAPCxyaFx/j4hwm4Z8bZF8c3GUOzETAGCXzxVFbJQcOVh5JT95px+QcJMZb0M6ORNZUjZuPjM4XEQ6N9MeDDpbUlNEHldYRWNGRUdyTEpDmSoaNjVubE17jItalIWBV4l9fF6GTVESAFyQxhFPfKkALkVfAEWAsAAguP8ERuD/Cs/j/wY8//8HV/z/BwD//wVWpvIbRV2MJDV0rCNSwP8VAP//Bub3/wQAdf8CANb/AQCw/wc4wf8EBBMhRBnJY+4AAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"cross validation\",\n    \"title\": \"cross validation\",\n    \"src\": \"/static/3828a04c506acbd8e40a2dd91852ee39/bb9c5/cross_validation.png\",\n    \"srcSet\": [\"/static/3828a04c506acbd8e40a2dd91852ee39/5a46d/cross_validation.png 300w\", \"/static/3828a04c506acbd8e40a2dd91852ee39/bb9c5/cross_validation.png 521w\"],\n    \"sizes\": \"(max-width: 521px) 100vw, 521px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Chose \", mdx(\"em\", {\n    parentName: \"li\"\n  }, \"k\"), \", the amount of folds and iterations.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"those folds has double duty training and validation.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Lets use the last fold as validation and remaining as training for our model.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Iterate over the folds using the next as validation.\")), mdx(\"h3\", null, \"The pronblem\"), mdx(\"p\", null, \"The above case work well for models where the resulting classs does not depends on previous or following resutls, However with sequence models that normally depends on other results it is not posible split the dataset because of the lost of infomation.\"), mdx(\"h2\", null, \"Solution\"), mdx(\"p\", null, \"To solve this problem we can count with two aproaches.\"), mdx(\"h3\", null, \"Cross validation in time series.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"630px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/d422512a53adcf49fbdf2e18bb4bd436/f058b/cross_validation_time_series.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"47%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACS0lEQVQoz0WQX2/SABTFD7hYX3yZPs3oqx/AJw2FFtrSFgr9CwOW6JKZbGZxigkDNqDrPwotLRujxGRv+m188hPNrJjsJCf35t7k5OQH3N8D1XMK8oiBbvMZ+ZKBYnFFrcGbx1rpdjETnNmC9TyPDYK5YNt2KQgC3vd9znVdJgxDYTqdMr1ejwWQRRpYu/gA9YpEw6OhmiR0uwAjop6LJ7nTTpm+84f5KL7OB/E1PfW8XBzHVBiGBd/3yTiO6SAIyMFgkH8M1KwCmj6D9kJAY8pgf85l2wGPZlCCEQiVVou1v39kf22WQnSzLt0mCb9a3XDL5ZJJkkRYrVYl0zQfGmaQqnouQh7XoNsa5FENqilDt9VMfShBdzQodv1Z9Vu9c2Bo3o8j6SYKVXcWyq7j1MIw1Hzfl3q9ngzgybah4eSwP6fQiVnszyi0wiI6EYOmX0BnwWZbcxrtJY1mxL7VjwuXJwbzex0Ul+ufVLLZsMl6XbAsi942TBkO36fsDI+CMiGhWXkYLgV5nEundkVmNJPMNlwKipND3aIOjHI+6h6QmyShZ2GU6/f75CNDqV+CMinDcCuQx2WoVzwMR4Q84qA7Fagmn1p3Khn5gkPDE6E6/J54WO5/1ipLd8z1B0N+G/ggoctCGghQJhKq5wJqFyKUcRXVHg95JEEe8f8tpTdlXM3WhyJqEwFiV1L1On/W5sUtwwdRRwTYUwJClwDzhQD3dbuTnwh4f3ew+/oVXrzZg/VnB/nD7Y87I3aLHQLNOwLvuoT0EgTwFP8A0njfBugSBioAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"cross validation\",\n    \"title\": \"cross validation\",\n    \"src\": \"/static/d422512a53adcf49fbdf2e18bb4bd436/f058b/cross_validation_time_series.png\",\n    \"srcSet\": [\"/static/d422512a53adcf49fbdf2e18bb4bd436/5a46d/cross_validation_time_series.png 300w\", \"/static/d422512a53adcf49fbdf2e18bb4bd436/0a47e/cross_validation_time_series.png 600w\", \"/static/d422512a53adcf49fbdf2e18bb4bd436/f058b/cross_validation_time_series.png 630w\"],\n    \"sizes\": \"(max-width: 630px) 100vw, 630px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"As with normal cross validation, we chose the number of folds \", mdx(\"em\", {\n    parentName: \"li\"\n  }, \"k\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Set \", mdx(\"em\", {\n    parentName: \"li\"\n  }, \"n\"), \" with the first folds to be used as training set.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Loop over the fold but keeping the last fold in the trining set.\")), mdx(\"p\", null, \"In this way the sequence is not broken in the training set. Although we can notice the last iteration is going to have mor training elemetns then more performace is expected.\"), mdx(\"h3\", null, \"Block time series cross validation.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"605px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/84752bb602b0d8884147369df3ba816c/90cbd/cv_block_time_series.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"69%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAABo0lEQVQoz42SbW8TMQzH9/2/Cm8QL3gzQEIToHKq1nadQIPdtV1Vcb2HXO6hsZ3Ynu6uKqMw4C8rihL98rdjX6iqiIbgmb0qN203mUxuBs3n88ViMZ1Ol8tlFEWz2QwRQwh+kKpeqGpTm6/35Ys39uXb7OH1qyrfG1uXRWGrylpbDasxxlrrBgFA0zTe+x5GROeAgiKJeNL/kHOOiHq4rmvn3HialnwZwfvPdf7pA8OBRYW5L+05GAaNp0CSGS6M95VR5X84W2v3+z0ini5kcCkauYzgXeT2V1fiWtYxBfkFTtM0z3MiOpEjDMg/ij6wyFT8n53Lssyy7KnzWQpVpx9vaLJw+fSaDx1LfwEjHEJo2/ZU8+/wAeR+6+MtddsHFTr/sOfgn68Ma0c6++av77y5/QImpxDOW/UX+AByG/tlwvXdd6iKI4yIdV0jIjwRDgIAIgKAfooIVftg1bppj2mLiLW26zpm3u12ZVmKyHq9HruwWq2MMcy82WyMqbznJI6LojjO9sjL8D/e+xCCqlprkyRJ0zSO47EXRMTDtCHiuHkEVkgnS+ZJ1tcAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"cross validation\",\n    \"title\": \"cross validation\",\n    \"src\": \"/static/84752bb602b0d8884147369df3ba816c/90cbd/cv_block_time_series.png\",\n    \"srcSet\": [\"/static/84752bb602b0d8884147369df3ba816c/5a46d/cv_block_time_series.png 300w\", \"/static/84752bb602b0d8884147369df3ba816c/0a47e/cv_block_time_series.png 600w\", \"/static/84752bb602b0d8884147369df3ba816c/90cbd/cv_block_time_series.png 605w\"],\n    \"sizes\": \"(max-width: 605px) 100vw, 605px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"lets \", mdx(\"em\", {\n    parentName: \"li\"\n  }, \"k\"), \" with the same purpouse as above.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"In each of the k sections we chose a percentage for training and other for testing.\")));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"title":"Cross validation with sequencial models"}}]}},"pageContext":{"pattern":"//seq2seq-cross-validation/","language":"en","intl":{"language":"en","languages":["en","es"],"messages":{"home-picture-alt":"Profile photo","home-github-tooltip":"Follow me on github","home-linkedin-tooltip":"Take a look to my linkedIn","home-email-tooltip":"Send me a message","home-blog-tooltip":"What I Learned this Week","blog-title":"What I Learned This Week","blog-sub":"Navigate thtough these post to see what I've learned"},"routed":false,"originalPath":"/wltw/seq2seq-cross-validation","redirect":true,"redirectDefaultLanguageToRoot":false,"defaultLanguage":"en","ignoredPaths":["/wltw/.+/"]}}},"staticQueryHashes":[]}